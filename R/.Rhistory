install.packages("tidyverse")
install.packages('ragg')
install.packages('ragg')
install.packages('ragg')
install.packages("tidyverse")
# Load original data
raw_1 <- read.xlsx(paste(base_dir, "Data/Boone_lab/Fluorescence/het_diploid_intensities_forMC.xlsx", sep=""), sheetIndex = 2)
# Packages
library(xlsx)
library(data.table)
library(dplyr)
library(tidyr)
# Set up environment
working_from = "home"
if (working_from == "home") {
base_dir = "/home/alvaro/MyStuff/TSSc/"
} else
if (working_from == "charite") {
base_dir = "C:/MyStuff/TSSC/"
}
# Load original data
raw_1 <- read.xlsx(paste(base_dir, "Data/Boone_lab/Fluorescence/het_diploid_intensities_forMC.xlsx", sep=""), sheetIndex = 2)
install.packages("readxl")
library(readxl)
# Load original data
raw_1 <- read_xlsx(paste(base_dir, "Data/Boone_lab/Fluorescence/het_diploid_intensities_forMC.xlsx", sep=""), sheet = 2)
View(raw_1)
# Load original data
raw_1 <- read_xlsx(paste(base_dir, "Data/Boone_lab/Fluorescence/het_diploid_intensities_forMC.xlsx", sep=""), sheet = 2)
raw_2 <- read_xlsx(paste(base_dir, "Data/Boone_lab/Fluorescence/het_diploid_intensities_forMC.xlsx", sep=""), sheet = 3)
raw_3 <- read_xlsx(paste(base_dir, "Data/Boone_lab/Fluorescence/het_diploid_intensities_forMC.xlsx", sep=""), sheet = 4)
# Save it as .csv
fwrite(raw_1, paste(base_dir, "Data/Boone_lab/Fluorescence/raw_1.csv", sep = ""))
fwrite(raw_2, paste(base_dir, "Data/Boone_lab/Fluorescence/raw_2.csv", sep = ""))
fwrite(raw_3, paste(base_dir, "Data/Boone_lab/Fluorescence/raw_3.csv", sep = ""))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(data.table)
library(tidyr)
library(ggplot2)
# Set up environment
working_from = "home"
if (working_from == "home") {
base_dir = "/home/alvaro/MyStuff/TSSc/"
} else
if (working_from == "charite") {
base_dir = "C:/MyStuff/TSSC/"
}
# Fluorescence data
raw_1 <- as.data.frame(fread(paste(base_dir, "Data/Boone_lab/Fluorescence/raw_1.csv", sep = "")))
raw_2 <- as.data.frame(fread(paste(base_dir, "Data/Boone_lab/Fluorescence/raw_2.csv", sep = "")))
raw_3 <- as.data.frame(fread(paste(base_dir, "Data/Boone_lab/Fluorescence/raw_3.csv", sep = "")))
## Put together replicates
full_fluorescence <- rbind(rbind(raw_1, raw_2), raw_3)
# tRNA synthetases data
synthetases <- as.data.frame(fread(paste(base_dir, "Data/synthetases/trna_synthetases.csv", sep="")))
# tRNA synthetases data
synthetases <- as.data.frame(fread(paste(base_dir, "Data/synthetases/trna_synthetases.csv", sep="")))
# Rep 1, all timepoints - full range
ggplot(data = raw_1, aes(x = `het:hom_mNG:mScar_ratio`)) +
geom_histogram(binwidth = 1) +
theme_light() +
labs(title = "Histogram of final ratio - all timepoints",
subtitle = "Replicate 1")
# Rep 1, all timepoints - 0 to 15
ggplot(data = raw_1, aes(x = `het:hom_mNG:mScar_ratio`)) +
geom_histogram(binwidth = 0.1, col = "black", fill = "grey") +
theme_light() +
coord_cartesian(xlim = c(0, 15)) +
labs(title = "Histogram of final ratio - all timepoints",
subtitle = "Replicate 1")
# Rep 1, all timepoints, log2
ggplot(data = raw_1, aes(x = log2(`het:hom_mNG:mScar_ratio`))) +
geom_histogram(binwidth = 1) +
theme_light() +
coord_cartesian(xlim = c(-12, 12)) +
labs(title = "Histogram of final ratio - all timepoints",
subtitle = "Replicate 1")
# Rep 1, time = 0, log2
ggplot(data = subset(raw_1, TimeAt37 == 0), aes(x = log2(`het:hom_mNG:mScar_ratio`))) +
geom_histogram(binwidth = 1) +
theme_light() +
coord_cartesian(xlim = c(-12, 12),
ylim = c(0, 500)) +
labs(title = "Histogram of final ratio - 0h",
subtitle = "Replicate 1")
# Rep 1, time = 12, log2
ggplot(data = subset(raw_1, TimeAt37 == 12), aes(x = log2(`het:hom_mNG:mScar_ratio`))) +
geom_histogram(binwidth = 1) +
theme_light() +
coord_cartesian(xlim = c(-12, 12),
ylim = c(0, 500)) +
labs(title = "Histogram of final ratio - 12h",
subtitle = "Replicate 1")
# Final ratio, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = log2(`het:hom_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)") +
labs(title = "Boxplots for the final ratio at all timepoints",
subtitle = "All replicates")
# Heterozygous ratio, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Heterozygous"), aes(x = as.factor(TimeAt37), y = log2(`average_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(average_mNG:mScar_ratio)") +
labs(title = "Boxplots for the non-normalized ratio at all timepoints",
subtitle = "All replicates")
# Heterozygous mNG, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Heterozygous"), aes(x = as.factor(TimeAt37), y = log2(average_intensity_mNG), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(mNG) intensity") +
labs(title = "Boxplots for heterozygous mNG at all timepoints",
subtitle = "All replicates")
# Heterozygous mScarlet, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Heterozygous"), aes(x = as.factor(TimeAt37), y = log2(average_intensity_mScar), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(mScarlet intensity)") +
labs(title = "Boxplots for heterozygous mScarlet at all timepoints",
subtitle = "All replicates")
View(full_fluorescence)
# Homozygous ratio, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Homozygous"), aes(x = as.factor(TimeAt37), y = log2(`average_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(average_mNG:mScar_ratio)") +
labs(title = "Boxplots for the non-normalized ratio at all timepoints",
subtitle = "All replicates, homozygous WT strains only")
# Homozygous mNG, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Homozygous"), aes(x = as.factor(TimeAt37), y = log2(average_intensity_mNG), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(mNG) intensity") +
labs(title = "Boxplots for homozygous mNG at all timepoints",
subtitle = "All replicates, homozygous WT strains only")
# Homozygous mScarlet, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Homozygous"), aes(x = as.factor(TimeAt37), y = log2(average_intensity_mScar), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(mScarlet intensity)") +
labs(title = "Boxplots for homozygous mScarlet at all timepoints",
subtitle = "All replicates, homozygous WT strains only")
# Homozygous ratio, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Homozygous"), aes(x = as.factor(TimeAt37), y = log2(`average_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(average_mNG:mScar_ratio)") +
labs(title = "Boxplots for the homozygous ratio at all timepoints",
subtitle = "All replicates, homozygous WT strains only")
# Homozygous mNG, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Homozygous"), aes(x = as.factor(TimeAt37), y = log2(average_intensity_mNG), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(mNG) intensity") +
labs(title = "Boxplots for homozygous mNG at all timepoints",
subtitle = "All replicates, homozygous WT strains only")
# Homozygous mScarlet, all timepoints
ggplot(data = subset(full_fluorescence, Status == "Homozygous"), aes(x = as.factor(TimeAt37), y = log2(average_intensity_mScar), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(mScarlet intensity)") +
labs(title = "Boxplots for homozygous mScarlet at all timepoints",
subtitle = "All replicates, homozygous WT strains only")
# Isolate fluorescence data for the synthetases and check for how many synthetases we have it
fluorescence_synthetases <- full_fluorescence %>%
filter(Gene %in% synthetases$Gene.symbol)
length(unique(fluorescence_synthetases$Gene))
# Take the average across replicates
test <- fluorescence_synthetases %>%
filter(`het:hom_mNG:mScar_ratio_status` == "mutant") %>%
group_by(Gene, Status, TimeAt37) %>%
summarise_at(vars(`het:hom_mNG:mScar_ratio`), list(average_ratio_across_replicates = mean))
# Get spaghetti plots
## Basic one
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light()
## Zoom in to see the ones at the bottom
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
coord_cartesian(ylim = c(0, 1.65))
# Isolate fluorescence data for the synthetases and check for how many synthetases we have it
fluorescence_synthetases <- full_fluorescence %>%
filter(Gene %in% synthetases$Gene.symbol)
length(unique(fluorescence_synthetases$Gene))
# Take the average across replicates
test <- fluorescence_synthetases %>%
filter(`het:hom_mNG:mScar_ratio_status` == "mutant") %>%
group_by(Gene, Status, TimeAt37) %>%
summarise_at(vars(`het:hom_mNG:mScar_ratio`), list(average_ratio_across_replicates = mean))
# Get spaghetti plots
## Basic one
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
labs(title = "Normalized mNG/mScarlet for TS tRNA synthetase strains")
## Zoom in to see the ones at the bottom
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
coord_cartesian(ylim = c(0, 1.65)) +
labs(title = "Normalized mNG/mScarlet for TS tRNA synthetase strains",
subtitle = "Zoomed in")
View(synthetases)
# Get a subset of the synthetase dataset for these ones, for a slide
synths_temp <- synthetases %>%
filter(Gene.symbol %in% full_fluorescence$Gene)
View(synths_temp)
# Get a subset of the synthetase dataset for these ones, for a slide
synths_temp <- synthetases %>%
filter(Gene.symbol %in% full_fluorescence$Gene) %>%
dplyr::select(Gene.name, Gene.symbol, Gene.secondaryIdentifier, mitochondrial, type, cofactor_or_enzyme)
View(synths_temp)
# Isolate fluorescence data for the synthetases and check for how many synthetases we have it
fluorescence_synthetases <- full_fluorescence %>%
filter(Gene %in% synthetases$Gene.symbol)
length(unique(fluorescence_synthetases$Gene))
# Take the average across replicates
test <- fluorescence_synthetases %>%
filter(`het:hom_mNG:mScar_ratio_status` == "mutant") %>%
group_by(Gene, Status, TimeAt37) %>%
summarise_at(vars(`het:hom_mNG:mScar_ratio`), list(average_ratio_across_replicates = mean))
# Get spaghetti plots
## Basic one
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
labs(title = "Normalized mNG/mScarlet for TS tRNA synthetase strains")
## Zoom in to see the ones at the bottom
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
coord_cartesian(ylim = c(0, 1.65)) +
labs(title = "Normalized mNG/mScarlet for TS tRNA synthetase strains",
subtitle = "Zoomed in")
# Get a subset of the synthetase dataset for these ones, for a slide
synths_temp <- synthetases %>%
filter(Gene.symbol %in% full_fluorescence$Gene) %>%
dplyr::select(Gene.name, Gene.symbol, Gene.secondaryIdentifier, mitochondrial, type, cofactor_or_enzyme)
# Isolate fluorescence data for the synthetases and check for how many synthetases we have it
fluorescence_synthetases <- full_fluorescence %>%
filter(Gene %in% synthetases$Gene.symbol)
length(unique(fluorescence_synthetases$Gene))
# Take the average across replicates
test <- fluorescence_synthetases %>%
filter(`het:hom_mNG:mScar_ratio_status` == "mutant") %>%
group_by(Gene, Status, TimeAt37) %>%
summarise_at(vars(`het:hom_mNG:mScar_ratio`), list(average_ratio_across_replicates = mean))
# Get spaghetti plots
## Basic one
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
labs(title = "Normalized mNG/mScarlet for TS tRNA synthetase strains") +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)")
## Zoom in to see the ones at the bottom
ggplot(data = test, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
coord_cartesian(ylim = c(0, 1.65)) +
labs(title = "Normalized mNG/mScarlet for TS tRNA synthetase strains",
subtitle = "Zoomed in") +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)")
# Get a subset of the synthetase dataset for these ones, for a slide
synths_temp <- synthetases %>%
filter(Gene.symbol %in% full_fluorescence$Gene) %>%
dplyr::select(Gene.name, Gene.symbol, Gene.secondaryIdentifier, mitochondrial, type, cofactor_or_enzyme)
# Total cell count, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = total_cell_count, group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("Total cell count") +
labs(title = "Boxplots for the total cell count at all timepoints",
subtitle = "All replicates")
# Total cell count, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = log2(total_cell_count), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("Total cell count") +
labs(title = "Boxplots for the total cell count at all timepoints",
subtitle = "All replicates")
# Undetectable cells mNG, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = undetectable_cells_mNG, group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("Undetectable cells mNG") +
labs(title = "Boxplots for undetectable cells mNG at all timepoints",
subtitle = "All replicates")
# Undetectable cells mNG, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = log2(undetectable_cells_mNG), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(Undetectable cells mNG)") +
labs(title = "Boxplots for undetectable cells mNG at all timepoints",
subtitle = "All replicates")
# Total cell count, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = log2(total_cell_count), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(Total cell count)") +
labs(title = "Boxplots for the total cell count at all timepoints",
subtitle = "All replicates")
# Undetectable cells mNG, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = log2(undetectable_cells_mNG), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(Undetectable cells mNG)") +
labs(title = "Boxplots for undetectable cells mNG at all timepoints",
subtitle = "All replicates")
# Undetectable cells mScar, all timepoints
ggplot(data = full_fluorescence, aes(x = as.factor(TimeAt37), y = log2(undetectable_cells_mScar), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(Undetectable cells mScar)") +
labs(title = "Boxplots for undetectable cells mScar at all timepoints",
subtitle = "All replicates")
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`))) +
geom_point() +
theme_light()
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`, col = TimeAt37))) +
geom_point() +
theme_light()
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light()
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light() +
coord_cartesian(ylim = c(-25, 20))
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light() +
coord_cartesian(ylim = c(-50, 50))
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light() +
coord_cartesian(ylim = c(-25, 25))
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`))) +
geom_point() +
theme_light() +
coord_cartesian(ylim = c(-25, 25))
, col = TimeAt37
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light() +
coord_cartesian(ylim = c(-25, 25))
# Final ratio vs. undetectable cells mNG
ggplot(data = full_fluorescence, aes(x = log2(total_cell_count), y = log2(undetectable_cells_mNG), col = TimeAt37)) +
geom_point() +
theme_light()
# Final ratio vs. undetectable cells mNG
ggplot(data = full_fluorescence, aes(x = log2(undetectable_cells_mNG), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light() +
coord_cartesian(ylim = c(-25, 25))
# Final ratio vs. undetectable cells mNG
ggplot(data = full_fluorescence, aes(x = log2(undetectable_cells_mNG), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light()
# Final ratio vs. undetectable cells mScar
ggplot(data = full_fluorescence, aes(x = log2(undetectable_cells_mScar), y = log2(`het:hom_mNG:mScar_ratio`), col = TimeAt37)) +
geom_point() +
theme_light()
fluorescence_temp <- full_fluorescence %>%
filter(Status == "Heterozygous")
strains <- unique(fluorescence_temp$Gene)
strains <- unique(fluorescence_temp$Gene)
gene <- strains[4]
temp <- fluorescence_temp %>%
filter(Gene == gene)
temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0]
fluorescence_temp <- full_fluorescence %>%
filter(Status == "Heterozygous")
strains <- unique(fluorescence_temp$Gene)
strains_with_right_pattern <- c()
for (gene in strains) {
temp <- fluorescence_temp %>%
filter(Gene == gene)
if ((mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0]) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4])) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4]) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8])) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8]) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 12]))) {
strains_with_right_pattern <- c(strains_with_right_pattern, unique(temp$Gene))
}
}
View(temp)
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0]) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4]))
fluorescence_temp <- full_fluorescence %>%
filter(Status == "Heterozygous")
strains <- unique(fluorescence_temp$Gene)
strains_with_right_pattern <- c()
for (gene in strains) {
temp <- fluorescence_temp %>%
filter(Gene == gene)
if ((mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T)) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8], na.rm = T)) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 12], na.rm = T))) {
strains_with_right_pattern <- c(strains_with_right_pattern, unique(temp$Gene))
}
}
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T))
temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0]
temp <- fluorescence_temp %>%
filter(Gene == gene)
legnth(unique(full_fluorescence$TimeAt37))
legnth(unique(full_fluorescence$TimeAt37))
length(unique(full_fluorescence$TimeAt37))
fluorescence_temp <- full_fluorescence %>%
filter(Status == "Heterozygous")
strains <- unique(fluorescence_temp$Gene)
strains_with_right_pattern <- c()
for (gene in strains) {
temp <- fluorescence_temp %>%
filter(Gene == gene)
if (length(unique(temp$TimeAt37)) == 7) {
if ((mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T)) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8], na.rm = T)) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 12], na.rm = T))) {
strains_with_right_pattern <- c(strains_with_right_pattern, unique(temp$Gene))
}
}
}
fluorescence_filtered <- full_fluorescence %>%
filter(Gene %in% strains_with_right_pattern)
# Final ratio, all timepoints
ggplot(data = fluorescence_filtered, aes(x = as.factor(TimeAt37), y = log2(`het:hom_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)") +
labs(title = "Boxplots for the final ratio at all timepoints",
subtitle = "All replicates")
# Final ratio, all timepoints
ggplot(data = fluorescence_filtered, aes(x = as.factor(TimeAt37), y = log2(`het:hom_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)") +
labs(title = "Boxplots for the final ratio at all timepoints",
subtitle = "All replicates")
# Spaghetti plot with these selected strains would be nice
ggplot(data = fluorescence_filtered, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
labs(title = "Normalized mNG/mScarlet for selected strains") +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)")
# Spaghetti plot with these selected strains - need to average across replicates first
fluorescence_filtered <- fluorescence_filtered %>%
summarise_at(vars(`het:hom_mNG:mScar_ratio`), list(average_ratio_across_replicates = mean))
ggplot(data = fluorescence_filtered, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
labs(title = "Normalized mNG/mScarlet for selected strains") +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)")
fluorescence_temp <- full_fluorescence %>%
filter(Status == "Heterozygous")
strains <- unique(fluorescence_temp$Gene)
strains_with_right_pattern <- c()
for (gene in strains) {
temp <- fluorescence_temp %>%
filter(Gene == gene)
if (length(unique(temp$TimeAt37)) == 7) {
if ((mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 0], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T)) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 4], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8], na.rm = T)) &
(mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 8], na.rm = T) >= mean(temp$`het:hom_mNG:mScar_ratio`[temp$TimeAt37 == 12], na.rm = T))) {
strains_with_right_pattern <- c(strains_with_right_pattern, unique(temp$Gene))
}
}
}
fluorescence_filtered <- full_fluorescence %>%
filter(Gene %in% strains_with_right_pattern)
# Final ratio, all timepoints
ggplot(data = fluorescence_filtered, aes(x = as.factor(TimeAt37), y = log2(`het:hom_mNG:mScar_ratio`), group = TimeAt37)) +
geom_boxplot() +
theme_light() +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)") +
labs(title = "Boxplots for the final ratio at all timepoints",
subtitle = "All replicates")
# Spaghetti plot with these selected strains - need to average across replicates first
fluorescence_filtered <- fluorescence_filtered %>%
group_by(Gene, Status, TimeAt37) %>%
summarise_at(vars(`het:hom_mNG:mScar_ratio`), list(average_ratio_across_replicates = mean))
ggplot(data = fluorescence_filtered, aes(x = TimeAt37, y = average_ratio_across_replicates, col = Gene)) +
geom_line(linewidth = 1) +
theme_light() +
labs(title = "Normalized mNG/mScarlet for selected strains") +
xlab("Time at 37ºC") +
ylab("log2(het:hom_mNG:mScar_ratio)")
