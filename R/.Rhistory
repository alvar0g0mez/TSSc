sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 37,
normalized_to_t0 = T,
long_version = T,
wrong_plate = F)
# Join results from this into a single long dataframe with all temperatures, to plot from
growth_long_full_norm <- rbind(rbind(rbind(growth_26_avg_norm_long, growth_30_avg_norm_long), growth_34_avg_norm_long), growth_37_avg_norm_long)
# Here we get:
# - Long version
# - Not normalized
# - Averaged across replicates
growth_26_avg_long_raw <- process_plate_reader_growth_curves(df = growth_26,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 26,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
growth_30_avg_long_raw <- process_plate_reader_growth_curves(df = growth_30,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 30,
normalized_to_t0 = F,
long_version = T,
wrong_plate = T)
growth_34_avg_long_raw <- process_plate_reader_growth_curves(df = growth_34,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 34,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
growth_37_avg_long_raw <- process_plate_reader_growth_curves(df = growth_37,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 37,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
# Join results from this into a single long dataframe with all temperatures, to plot from
growth_long_full_raw <- rbind(rbind(rbind(growth_26_avg_long_raw, growth_30_avg_long_raw), growth_34_avg_long_raw), growth_37_avg_long_raw)
}
# Those from the second set
if (which_try == "second_try"|which_try == "third_try") {
# Here we get:
# - Long version
# - Normalized to time 0
# - Averaged across replicates
growth_22_avg_norm_long <- process_plate_reader_growth_curves(df = growth_22,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 22,
normalized_to_t0 = T,
long_version = T,
wrong_plate = F)
growth_26_avg_norm_long <- process_plate_reader_growth_curves(df = growth_26,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 26,
normalized_to_t0 = T,
long_version = T,
wrong_plate = F)
growth_30_avg_norm_long <- process_plate_reader_growth_curves(df = growth_30,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 30,
normalized_to_t0 = T,
long_version = T,
wrong_plate = F)
growth_34_avg_norm_long <- process_plate_reader_growth_curves(df = growth_34,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 34,
normalized_to_t0 = T,
long_version = T,
wrong_plate = F)
# Join results from this into a single long dataframe with all temperatures, to plot from
growth_long_full_norm <- rbind(rbind(rbind(growth_22_avg_norm_long, growth_26_avg_norm_long), growth_30_avg_norm_long), growth_34_avg_norm_long)
# Here we get:
# - Wide version
# - No normalization
# - Averaged across replicates
# --> In order to check what was the issue at 30ºC!
growth_22_avg <- process_plate_reader_growth_curves(df = growth_22,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 22,
normalized_to_t0 = F,
long_version = F,
wrong_plate = F)
growth_26_avg <- process_plate_reader_growth_curves(df = growth_26,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 26,
normalized_to_t0 = F,
long_version = F,
wrong_plate = F)
growth_30_avg <- process_plate_reader_growth_curves(df = growth_30,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 30,
normalized_to_t0 = F,
long_version = F,
wrong_plate = F)
growth_34_avg <- process_plate_reader_growth_curves(df = growth_34,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 34,
normalized_to_t0 = F,
long_version = F,
wrong_plate = F)
# Here we get:
# - Long version
# - No normalization
# - Averaged across replicates
growth_22_avg_long_raw <- process_plate_reader_growth_curves(df = growth_22,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 22,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
growth_26_avg_long_raw <- process_plate_reader_growth_curves(df = growth_26,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 26,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
growth_30_avg_long_raw <- process_plate_reader_growth_curves(df = growth_30,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 30,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
growth_34_avg_long_raw <- process_plate_reader_growth_curves(df = growth_34,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 34,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
# Join results from this into a single long dataframe with all temperatures, to plot from
growth_long_full_raw <- rbind(rbind(rbind(growth_22_avg_long_raw, growth_26_avg_long_raw), growth_30_avg_long_raw), growth_34_avg_long_raw)
}
growth_long_full_norm <- growth_long_full_norm %>%
dplyr::mutate(Time_secs = Time,
Time = Time_secs/3600)
growth_long_full_raw <- growth_long_full_raw %>%
dplyr::mutate(Time_secs = Time,
Time = Time_secs/3600)
# Cut off at time = 6h
if (which_try == "third_try") {
growth_long_full_norm <- cut_off_at_a_certain_time(growth_long_full_norm, 6)
growth_long_full_raw <- cut_off_at_a_certain_time(growth_long_full_raw, 6)
}
# In the first set of measurements, first two temperatures were in one incubator, next two in another one, should check the names and put them somewhere in the graph - similar for the second set, there is a mix of the 2 different incubators/PlateReaders/whatever they are
# They should be in the second sheet of each of these Excel files
# Be careful, I am not doing this from the original data but from the long version, so if I change anything it might get biased (more observations from one temperature than another or whatever)
if (which_try == "first_try") {
ggplot() +
geom_line(data = subset(growth_long_full_norm, Temp_set == 26), aes(x = Time, y = Temp_observed), col = "darkgreen", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 30), aes(x = Time, y = Temp_observed), col = "blue", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 34), aes(x = Time, y = Temp_observed), col = "purple", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 37), aes(x = Time, y = Temp_observed), col = "orange", linewidth = 1) +
geom_hline(yintercept = 26, col = "black") +
geom_hline(yintercept = 30, col = "black") +
geom_hline(yintercept = 34, col = "black") +
geom_hline(yintercept = 37, col = "black") +
theme_light() +
xlab("Time (h)") +
ylab("Temperature") +
labs(title = "How well did the incubators maintain their assigned temperature?",
subtitle = try_for_plots)
} else
if (which_try == "second_try") {
ggplot() +
geom_line(data = subset(growth_long_full_norm, Temp_set == 22), aes(x = Time, y = Temp_observed), col = "orange", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 26), aes(x = Time, y = Temp_observed), col = "darkgreen", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 30), aes(x = Time, y = Temp_observed), col = "blue", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 34), aes(x = Time, y = Temp_observed), col = "purple", linewidth = 1) +
geom_hline(yintercept = 22, col = "black") +
geom_hline(yintercept = 26, col = "black") +
geom_hline(yintercept = 30, col = "black") +
geom_hline(yintercept = 34, col = "black") +
theme_light() +
xlab("Time (h)") +
ylab("Temperature") +
labs(title = "How well did the incubators maintain their assigned temperature?",
subtitle = try_for_plots)
} else
if (which_try == "third_try") {
ggplot() +
geom_line(data = subset(growth_long_full_norm, Temp_set == 22), aes(x = Time, y = Temp_observed), col = "orange", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 26), aes(x = Time, y = Temp_observed), col = "darkgreen", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 30), aes(x = Time, y = Temp_observed), col = "blue", linewidth = 1) +
geom_line(data = subset(growth_long_full_norm, Temp_set == 34), aes(x = Time, y = Temp_observed), col = "purple", linewidth = 1) +
geom_hline(yintercept = 22, col = "black") +
geom_hline(yintercept = 26, col = "black") +
geom_hline(yintercept = 30, col = "black") +
geom_hline(yintercept = 34, col = "black") +
theme_light() +
xlab("Time (h)") +
ylab("Temperature") +
labs(title = "How well did the incubators maintain their assigned temperature?",
subtitle = try_for_plots)
}
ggplot(data = subset(growth_long_full_raw, Time == 0),
aes(x = Strain, y = OD_raw, col = as.factor(Temp_set))) +
geom_point() +
theme_light() +
labs(title = "ODs at time = 0, for each strain at each temperature",
subtitle = try_for_plots,
col = "Temperature") +
ylab("OD") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
#t_26_just_data <- growth_26_avg %>%
#  dplyr::select(-c(Time, Temperature))
#t_30_just_data <- growth_30_avg %>%
#  dplyr::select(-c(Time, Temperature))
#t_34_just_data <- growth_34_avg %>%
#  dplyr::select(-c(Time, Temperature))
#
#
#hist(as.matrix(t_26_just_data))
#hist(as.matrix(t_30_just_data))
#hist(as.matrix(t_34_just_data))
plot_list <- list()
strains <- sort(unique(sample_ids$Sys.Name))
for (i in 1:length(strains)) {
strain <- strains[i]
strain_type <- sample_ids$Status[sample_ids$Sys.Name == strain][1]
gene_name <- sample_ids$Gene.name[sample_ids$Sys.Name == strain][1]
temp <- growth_long_full_raw %>%
dplyr::filter(Strain == strain)
if (strain_type == "Synthetase") {
lethal_temp <- sample_ids$Lethal_temp[sample_ids$Sys.Name == strain][1]
plot_list[[i]] <- ggplot(data = temp, aes(x = Time, y = OD_raw, group = as.factor(Temp_set), col = as.factor(Temp_set))) +
geom_line(linewidth = 1) +
theme_light() +
xlab("Time (h)") +
ylab("OD 600") +
labs(title = glue("{strain} - {strain_type}"),
subtitle = glue("{gene_name} - {lethal_temp}"),
col = "Temperature (ºC)") +
coord_cartesian(ylim = c(0, 1.25))
} else
if (strain_type == "Lethal") {
lethal_temp <- sample_ids$Lethal_temp[sample_ids$Sys.Name == strain][1]
plot_list[[i]] <- ggplot(data = temp, aes(x = Time, y = OD_raw, group = as.factor(Temp_set), col = as.factor(Temp_set))) +
geom_line(linewidth = 1) +
theme_light() +
xlab("Time (h)") +
ylab("OD 600") +
labs(title = glue("{strain} - {strain_type}"),
subtitle = glue("{lethal_temp}"),
col = "Temperature (ºC)") +
coord_cartesian(ylim = c(0, 1.25))
}
else
{
plot_list[[i]] <- ggplot(data = temp, aes(x = Time, y = OD_raw, group = as.factor(Temp_set), col = as.factor(Temp_set))) +
geom_line(linewidth = 1) +
theme_light() +
xlab("Time (h)") +
ylab("OD 600") +
labs(title = glue("{strain} - {strain_type}"),
col = "Temperature (ºC)") +
coord_cartesian(ylim = c(0, 1.25))
}
}
## List of ggplot objects has to be turned to list of grobs for grid.arrange to work
my_grobs <- lapply(plot_list, ggplotGrob)
## Print to PDF
output_file = paste(base_dir, "TSSC/Output/Plots/pilot/growth_curves/gcs_trna_synthetases_raw_", which_try, ".pdf", sep = "")
ggsave(
filename = output_file,
plot = marrangeGrob(my_grobs, nrow=3, ncol=3),
width = 15, height = 9
)
for (i in 1:length(plot_list)) {
print(plot_list[[i]])
}
plot_list <- list()
temp <- sample_ids %>%
dplyr::arrange(Status)
strains <- unique(temp$Sys.Name)
for (i in 1:length(strains)) {
strain <- strains[i]
strain_type <- sample_ids$Status[sample_ids$Sys.Name == strain][1]
gene_name <- sample_ids$Gene.name[sample_ids$Sys.Name == strain][1]
temp <- growth_long_full_norm %>%
dplyr::filter(Strain == strain)
if (strain_type == "Synthetase") {
lethal_temp <- sample_ids$Lethal_temp[sample_ids$Sys.Name == strain][1]
plot_list[[i]] <- ggplot(data = temp, aes(x = Time, y = OD_norm, group = as.factor(Temp_set), col = as.factor(Temp_set))) +
geom_line(linewidth = 1) +
theme_light() +
xlab("Time (h)") +
ylab("Ratio to OD at T0") +
labs(title = glue("{strain} - {strain_type}"),
subtitle = glue("{gene_name} - {lethal_temp}"),
col = "Temperature (ºC)") +
coord_cartesian(ylim = c(0, 12.5))
} else
if (strain_type == "Lethal") {
lethal_temp <- sample_ids$Lethal_temp[sample_ids$Sys.Name == strain][1]
plot_list[[i]] <- ggplot(data = temp, aes(x = Time, y = OD_norm, group = as.factor(Temp_set), col = as.factor(Temp_set))) +
geom_line(linewidth = 1) +
theme_light() +
xlab("Time (h)") +
ylab("OD 600") +
labs(title = glue("{strain} - {strain_type}"),
subtitle = glue("{lethal_temp}"),
col = "Temperature (ºC)") +
coord_cartesian(ylim = c(0, 12.5))
}
else
{
plot_list[[i]] <- ggplot(data = temp, aes(x = Time, y = OD_norm, group = as.factor(Temp_set), col = as.factor(Temp_set))) +
geom_line(linewidth = 1) +
theme_light() +
xlab("Time (h)") +
ylab("Ratio to OD at T0") +
labs(title = glue("{strain} - {strain_type}"),
col = "Temperature (ºC)") +
coord_cartesian(ylim = c(0, 12.5))
}
}
## List of ggplot objects has to be turned to list of grobs for grid.arrange to work
my_grobs <- lapply(plot_list, ggplotGrob)
## Print to PDF
output_file = paste(base_dir, "TSSC/Output/Plots/pilot/growth_curves/gcs_trna_synthetases_norm_to_t0_", which_try, ".pdf", sep = "")
ggsave(
filename = output_file,
plot = marrangeGrob(my_grobs, nrow=3, ncol=3),
width = 15, height = 9
)
for (i in 1:length(plot_list)) {
print(plot_list[[i]])
}
growth_long_full_raw_OD_05 <- growth_long_full_raw %>%
dplyr::filter(OD_raw > 0.45 & OD_raw < 0.55)
plot_list <- list()
strains <- sort(sample_ids$Sys.Name[sample_ids$Status == "Synthetase"|sample_ids$Status == "Control"|sample_ids$Status == "BY4741"])
for (i in 1:length(strains)) {
strain <- strains[[i]]
temp <- growth_long_full_raw_OD_05 %>%
dplyr::filter(Strain == strain)
temp$Temp_set <- as.factor(temp$Temp_set)
plot_list[[i]] <- ggplot(data = temp, aes(x = Temp_set, y = Time, group = Temp_set)) +
geom_boxplot(aes(fill = Temp_set)) +
theme_light() +
labs(title = glue("{strain}"),
fill = "Temperature") +
xlab("Temperature") +
ylab("Time (h)")
}
## List of ggplot objects has to be turned to list of grobs for grid.arrange to work
my_grobs <- lapply(plot_list, ggplotGrob)
## Print to PDF
output_file = paste(base_dir, "TSSC/Output/Plots/pilot/growth_curves/gcs_trna_synthetases_raw_OD_05_boxplots_", which_try, ".pdf", sep = "")
ggsave(
filename = output_file,
plot = marrangeGrob(my_grobs, nrow=3, ncol=3),
width = 15, height = 9
)
for (i in 1:length(plot_list)) {
print(plot_list[[i]])
}
# Synthetases
synthetases <- fread(paste(base_dir, "tRNA_KOs/Data/basic/trna_synthetases.csv", sep=""))
# Supplementary table from Li et al., 2011 (contains the information of the references)
li_et_al <- fread(paste(base_dir, "TSSC/Data/Articles/Li_et_al_2011/Li_et_al_S1.csv", sep="")) %>%
dplyr::select(Sys.Name, Reference.or.Source, ts.on.SC) %>%
dplyr::rename(Gene.secondaryIdentifier = Sys.Name) %>%
dplyr::filter(Gene.secondaryIdentifier %in% synthetases$Gene.secondaryIdentifier)
print(li_et_al$Reference.or.Source)
# Grab the strains we want to use for the proteomics experiment: the tRNA synthetase ts strains, and 2 of the replicates of the control strain
strains_for_proteomics <- sample_ids %>%
dplyr::filter(Status == "Synthetase"|Sys.Name == "Control_1"|Sys.Name == "Control_2")
# Add columns with the average OD of each strain at each temperature
temperatures <- unique(growth_long_full_raw$Temp_set)
strains <- strains_for_proteomics$Sys.Name
# Iterate over temperatures
for (i in 1:length(temperatures)) {
temperature <- temperatures[i]
avg_ods_this_temp_20 <- c()
avg_ods_this_temp_48 <- c()
# For each temperature, iterates over strains, and get the average OD for each of them (at this temperature - at 20h and 48h)
for (j in 1:length(strains)) {
strain <- strains[j]
temp_20 <- growth_long_full_raw %>%
dplyr::filter(Strain == strain & Temp_set == temperature & Time > 19.5 & Time < 20.5)     # Time is not always exactly 20h
temp_48 <- growth_long_full_raw %>%
dplyr::filter(Strain == strain & Temp_set == temperature & Time > 47.5 & Time < 48.5)     # Time is not always exactly 48h
avg_ods_this_temp_20 <- c(avg_ods_this_temp_20, mean(temp_20$OD_raw))
avg_ods_this_temp_48 <- c(avg_ods_this_temp_48, mean(temp_48$OD_raw))
}
# Add the vectors containing the collected average ODs at 20h and 48h at this temperature to the output dataframe
strains_for_proteomics[[paste("OD_at_", temperature, "_20h", sep="")]] <- avg_ods_this_temp_20
strains_for_proteomics[[paste("OD_at_", temperature, "_48h", sep="")]] <- avg_ods_this_temp_48
}
# Add two columns which summarize whether this strain is viable (OD > 0.2) at 48h - at 30ºC and 34ºC
strains_for_proteomics <- strains_for_proteomics %>%
dplyr::mutate(Viable_at_30 = case_when(OD_at_30_48h > 0.2 ~ "Yes",
TRUE ~ "No"),
Viable_at_34 = case_when(OD_at_34_48h > 0.2 ~ "Yes",
TRUE ~ "No"))
# Get 2 versions of this dataframe: one for the first 3 rows (to be harvested at ~20h), another one for the last 3 rows (to be harvested at ~48h)
# Each of these is first triplicated (since each row in the dataframe represents a strain, and we'll have 3 replicates of each), then each of the dataframes is randomized separately, so the sample layout will not be the same across the first 3 rows and across the last 3 - I hope this is feasible with the Rotor or Pixl or whatever it is?? If I give it the location of each of them in the old plate?? So that we can randomize the samples, which I think is good practice, but obviously so that Wenxi doesn't have to do it manually
# Anyway, after randomizing the rows in each dataframe, I replicate this three times
strains_for_proteomics_randomized_1 <- slice(strains_for_proteomics, rep(1:nrow(strains_for_proteomics), 3))                            # Get triplicates of the rows
strains_for_proteomics_randomized_1 <- strains_for_proteomics_randomized_1[sample(nrow(strains_for_proteomics_randomized_1)),] %>%      # Randomize row order
dplyr::mutate(Column = rep(seq(from = 1, to = 12, by = 1), 3),                                                                        # Assign columns
Row = c(rep("A", 12), rep("B", 12), rep("C", 12))) %>%                                                                  # Assign rows
add_well_IDs(column_numbers_col = "Column",
row_letters_col = "Row")
strains_for_proteomics_randomized_2 <- slice(strains_for_proteomics, rep(1:nrow(strains_for_proteomics), 3))                            # Get triplicates of the rows
strains_for_proteomics_randomized_2 <- strains_for_proteomics_randomized_2[sample(nrow(strains_for_proteomics_randomized_2)),] %>%      # Randomize row order
dplyr::mutate(Column = rep(seq(from = 1, to = 12, by = 1), 3),                                                                        # Assign columns
Row = c(rep("E", 12), rep("F", 12), rep("G", 12))) %>%                                                                  # Assign rows
add_well_IDs(column_numbers_col = "Column",
row_letters_col = "Row")
# Join the 2 so we get the whole layout for the plate
strains_for_proteomics_final <- rbind(strains_for_proteomics_randomized_1, strains_for_proteomics_randomized_2)
# Color by strain
raw_map(data = strains_for_proteomics_final$Sys.Name,
well = strains_for_proteomics_final$Well_ID,
plate = 96) +
ggtitle("Sample layout for proteomics experiment") +
theme_dark() +
theme(axis.text=element_text(size=6),
legend.key.size = unit(0.5, 'cm'),          # change legend key size
legend.key.height = unit(0.5, 'cm'),        # change legend key height
legend.key.width = unit(0.5, 'cm')) +       # change legend key width
guides(fill = guide_legend(ncol = 2)) +
labs(fill = "Strain")
# Color by strain type
raw_map(data = strains_for_proteomics_final$Status,
well = strains_for_proteomics_final$Well_ID,
plate = 96) +
theme_dark() +
theme(axis.text=element_text(size=6),
legend.key.size = unit(0.5, 'cm'),          # change legend key size
legend.key.height = unit(0.5, 'cm'),        # change legend key height
legend.key.width = unit(0.5, 'cm')) +       # change legend key width)
labs(title = "Sample layout for proteomics experiment",
fill = "Strain type")
# Color by viable at 30ºC
raw_map(data = strains_for_proteomics_final$Viable_at_30,
well = strains_for_proteomics_final$Well_ID,
plate = 96) +
theme_dark() +
theme(axis.text=element_text(size=6),
legend.key.size = unit(0.5, 'cm'),          # change legend key size
legend.key.height = unit(0.5, 'cm'),        # change legend key height
legend.key.width = unit(0.5, 'cm')) +       # change legend key width)
labs(title = "Sample layout for proteomics experiment",
fill = "Viable at 30ºC")
# Color by viable at 34ºC
raw_map(data = strains_for_proteomics_final$Viable_at_34,
well = strains_for_proteomics_final$Well_ID,
plate = 96) +
theme_dark() +
theme(axis.text=element_text(size=6),
legend.key.size = unit(0.5, 'cm'),          # change legend key size
legend.key.height = unit(0.5, 'cm'),        # change legend key height
legend.key.width = unit(0.5, 'cm')) +       # change legend key width)
labs(title = "Sample layout for proteomics experiment",
fill = "Viable at 34ºC")
# Come up with the full sample IDs of the plate
sample_ids_new_2 <- create_full_sample_ids_for_a_plate(df = growth_26,
sample_ids = sample_ids,
replicates = list(c("A", "B", "C"), c("E", "F", "G")),
empty_rows = c("D", "H"),
fixed_temp = 26,
normalized_to_t0 = F,
long_version = T,
wrong_plate = F)
# Fix well IDs
sample_ids_new_2 <- fix_well_ids_with_no_0s(sample_ids_new_2, "GC96")
# Color by viable at 34ºC
raw_map(data = sample_ids_new_2$Sys.Name,
well = sample_ids_new_2$GC96,
plate = 96) +
theme_dark() +
theme(axis.text=element_text(size=6),
legend.key.size = unit(0.5, 'cm'),          # change legend key size
legend.key.height = unit(0.5, 'cm'),        # change legend key height
legend.key.width = unit(0.5, 'cm')) +       # change legend key width)
labs(title = "Sample layout for growth curves",
fill = "Strains")
